<jqassistant-rules xmlns="http://schema.jqassistant.org/rule/v1.10"
									 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
									 xsi:schemaLocation="http://schema.jqassistant.org/rule/v1.10 http://schema.jqassistant.org/rule/jqassistant-rule-v1.10.xsd">

	<group id="kolibri:Default">
		<includeConstraint refId="kolibri:*"/>
	</group>

	<concept id="kolibri:PropType">
		<description>Markiert Type-Alias, das Prop-Felder definiert, und die dazugehörigen Members als PropType bzw. PropTypeFields</description>
		<cypher><![CDATA[
				MATCH (m:TS:Module)-[:EXPORTS]->(ta:TS:TypeAlias)
				WHERE m.fileName STARTS WITH "/src/types/props"
				WITH ta
				MATCH (ta)-[:OF_TYPE]->(:TS:Type:Object)-[:HAS_MEMBER]->(member:TS:ObjectMember)
				SET ta:KoliBri:PropType
				SET member:KoliBri:PropTypeField
				CREATE (ta)-[:DEFINES]->(member)
				RETURN ta.name as PropType, collect(member.name) as PropTypeFields
			]]></cypher>
	</concept>

	<constraint id="kolibri:PropTypeFieldMustBeUnique">
		<requrires refid="kolibri:PropType"/>
		<description>Prop-Felder müssen global unique sein.</description>
		<cypher><![CDATA[
				MATCH (pt:KoliBri:PropType)-[:DEFINES]-(pf:KoliBri:PropTypeField)
				WITH pt.name AS propType, pf.name AS propName
				WITH propName, COLLECT(propType) AS types
				WHERE SIZE(types) > 1
				RETURN propName, types
		]]></cypher>
	</constraint>

</jqassistant-rules>
